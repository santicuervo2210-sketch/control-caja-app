# Configuraci√≥n de Supabase
# Obt√©n estos valores desde https://supabase.com/dashboard/project/[tu-proyecto]/settings/api

# URL de tu proyecto Supabase
NEXT_PUBLIC_SUPABASE_URL=https://tu-proyecto.supabase.co

# Clave an√≥nima (public) de Supabase
NEXT_PUBLIC_SUPABASE_ANON_KEY=tu-anon-key-aqui

# üìã PASOS PARA CONFIGURAR SUPABASE:

# 1. üîê Crear cuenta y proyecto:
#    - Ve a https://supabase.com
#    - Reg√≠strate gratis
#    - Crea un nuevo proyecto
#    - Elige un nombre (ej: "control-caja-app")
#    - Espera a que se cree (2-3 minutos)

# 2. üóÑÔ∏è Crear las tablas:
#    - Ve a "SQL Editor" en el men√∫ lateral
#    - Copia y pega todo el SQL de abajo
#    - Haz clic en "Run"

# 3. üîë Obtener las credenciales:
#    - Ve a "Settings" > "API" en el men√∫ lateral
#    - Copia la "URL" del proyecto
#    - Copia la "anon public" key

# 4. ‚öôÔ∏è Configurar la aplicaci√≥n:
#    - Crea un archivo llamado .env.local en la ra√≠z del proyecto
#    - Copia estas l√≠neas y pega tus valores reales:
#
#    NEXT_PUBLIC_SUPABASE_URL=https://tu-proyecto.supabase.co
#    NEXT_PUBLIC_SUPABASE_ANON_KEY=tu-anon-key-aqui
#
# 5. üöÄ Reiniciar:
#    - Guarda el archivo .env.local
#    - Reinicia la aplicaci√≥n (npm run dev)
#    - Ve a "Configuraci√≥n" para verificar que dice "Supabase conectado: ‚úÖ S√≠"

# üéâ ¬°LISTO! Ahora tus datos estar√°n en la nube y sincronizados entre dispositivos.

# SQL para crear las tablas en Supabase:
# Ve a https://supabase.com/dashboard/project/[tu-proyecto]/sql/editor
# y ejecuta este SQL:

CREATE TABLE IF NOT EXISTS reportes_diarios (
  id TEXT PRIMARY KEY,
  fecha TEXT NOT NULL,
  turno TEXT NOT NULL,
  hora_inicio TEXT,
  hora_cambio TEXT,
  empleada TEXT,
  caja_inicial INTEGER DEFAULT 0,
  ventas JSONB DEFAULT '[]'::jsonb,
  ingreso_efectivo INTEGER DEFAULT 0,
  ingreso_transferencia INTEGER DEFAULT 0,
  total INTEGER DEFAULT 0,
  timestamp BIGINT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL
);

CREATE TABLE IF NOT EXISTS personal (
  id INTEGER PRIMARY KEY,
  nombre TEXT NOT NULL,
  activo BOOLEAN DEFAULT true,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL
);

CREATE TABLE IF NOT EXISTS reportes_semanales (
  timestamp BIGINT PRIMARY KEY,
  semana TEXT NOT NULL,
  total_semana INTEGER DEFAULT 0,
  total_manana INTEGER DEFAULT 0,
  total_tarde INTEGER DEFAULT 0,
  dias_trabajados INTEGER DEFAULT 0,
  reportes JSONB DEFAULT '[]'::jsonb,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc'::text, NOW()) NOT NULL
);

-- Crear √≠ndices para mejor rendimiento
CREATE INDEX IF NOT EXISTS idx_reportes_diarios_fecha ON reportes_diarios(fecha);
CREATE INDEX IF NOT EXISTS idx_reportes_diarios_turno ON reportes_diarios(turno);
CREATE INDEX IF NOT EXISTS idx_personal_activo ON personal(activo);

-- Pol√≠ticas RLS (Row Level Security) - opcional pero recomendado
ALTER TABLE reportes_diarios ENABLE ROW LEVEL SECURITY;
ALTER TABLE personal ENABLE ROW LEVEL SECURITY;
ALTER TABLE reportes_semanales ENABLE ROW LEVEL SECURITY;

-- Pol√≠ticas para permitir acceso p√∫blico (ajusta seg√∫n tus necesidades de seguridad)
CREATE POLICY "Permitir todo en reportes_diarios" ON reportes_diarios FOR ALL USING (true);
CREATE POLICY "Permitir todo en personal" ON personal FOR ALL USING (true);
CREATE POLICY "Permitir todo en reportes_semanales" ON reportes_semanales FOR ALL USING (true);